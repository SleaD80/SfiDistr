dbdata:
  image: busybox:latest
  command: echo dbdata
  volumes:
    - /home/dimaip/docker/sfi.ru/lib/mysql:/var/lib/mysql

redis:
  image: redis

db:
  image: tutum/mariadb:latest
  expose:
    - 3306
  volumes_from:
    - dbdata
  environment:
    MARIADB_PASS: pass

webdata:
  image: busybox:latest
  command: echo webdata
  volumes:
    - /home/dimaip/docker/sfi.ru/data:/data

web:
  image: dimaip/sfidistr:latest
  ports:
    - '80'
  links:
    - db:db
    - redis
  volumes_from:
    - webdata
  environment:
    VIRTUAL_HOST: 'sfi.ru,dev.sfi.ru,next.sfi.ru'
    T3APP_NAME: 'sfi.ru'
    T3APP_BUILD_REPO_URL: 'https://github.com/sfi-ru/SfiDistr.git'

ssh:
  image: million12/php-app-ssh
  ports:
    - '1122:22'
  links:
    - db:db
    - redis
    - web:web
  volumes_from:
    - webdata
  environment:
    IMPORT_GITHUB_PUB_KEYS: dimaip
